# Story 3.5: 在 API 调用失败时显示明确的错误提示和重试选项

## Status: Review

## Story

- As a 用户
- I want 在 API 调用失败或出现其他错误时，我希望看到一个**明确的错误提示 (Toast)**，并有机会**重试**操作
- so that 我能了解发生了什么，并能从错误中恢复，而不是被卡在一个无响应的界面

## Acceptance Criteria (ACs)

1.  [x] 当 `ApiService` 的调用抛出异常时，该异常会被前端的调用方捕获。
2.  [x] 捕获到异常后，会调用 `Toast` 服务，显示一个用户友好的错误消息（例如："分析失败，请稍后重试"）。
3.  [x] `isLoading` 状态会被正确地设置为 `false`，移除骨架屏。
4.  [x] UI 上会显示一个"重试"按钮。
5.  [x] 点击"重试"按钮，会重新触发对同一关键词的分析流程。

## Tasks / Subtasks

- [x] **Task 1: 实现 API 调用的错误捕获**
  - [x] 在 `side-panel-app.tsx` 中，将 `apiService.analyzeKeyword()` 的调用包裹在一个 `try...catch` 块中。
  - [x] 在 `catch` 块中，获取错误对象。

- [x] **Task 2: 显示错误信息**
  - [x] 在 `catch` 块中，调用 `showToast()` 函数（来自 `useToast` hook），传入一个格式化的错误消息。
  - [x] 创建一个新的 React state，例如 `const [error, setError] = useState<Error | null>(null);` 来保存错误状态。
  - [x] 在 `catch` 块中，调用 `setError(error)`。
  - [x] 在 `try` 块的开始处，调用 `setError(null)` 来清除上一次的错误。

- [x] **Task 3: 实现重试 UI 和逻辑**
  - [x] 创建一个新的组件 `ErrorState.tsx`，它接收 `onRetry` 函数作为 prop。
  - [x] 在 `ErrorState.tsx` 内部，显示一个错误图标、错误消息和一个"重试"按钮。
  - [x] "重试"按钮的 `onClick` 事件会调用 `props.onRetry`。
  - [x] 在 `side-panel-app.tsx` 中，使用条件渲染来显示 `ErrorState` 组件：
    ```jsx
    {error ? <ErrorState onRetry={() => handleFetchInsight(currentKeyword)} /> : ...}
    ```
    (这里的逻辑需要与 `isLoading` 的逻辑结合好，通常是 `isLoading` 之后再判断 `error`) 
# Story 3.4: 在 AI 分析期间显示加载动画 (Loading Skeleton)

## Status: Review

## Story

- As a 用户
- I want 如果 AI 分析耗时超过 400ms，我希望看到一个**加载动画 (Loading Skeleton)**
- so that 我能明确知晓系统正在处理我的请求，而不是卡住了或没有响应

## Acceptance Criteria (ACs)

1.  [x] 当 API 调用开始时，一个 `isLoading` 状态被设置为 `true`。
2.  [x] 在 `isLoading` 为 `true` 时，`InsightCard` 组件的位置会显示一个骨架屏（Skeleton）UI。
3.  [x] 骨架屏的布局应与最终 `InsightCard` 的布局大致相似，以避免内容加载后页面布局发生剧烈跳动。
4.  [x] API 调用结束后（无论成功或失败），`isLoading` 状态被设置为 `false`，骨架屏被替换为真实内容或错误提示。
5.  [x] 根据 PRD，只有当加载时间超过 400ms 时才显示骨架屏。但为了简化 MVP 实现，我们将**立即显示**骨架屏，后续再优化为延迟显示。

## Tasks / Subtasks

- [x] **Task 1: 创建骨架屏组件**
  - [x] 创建一个新的组件 `InsightCardSkeleton.tsx`。
  - [x] 在该组件内部，使用 UI 库（如 Shadcn UI）的 `<Skeleton>` 组件来搭建一个与 `InsightCard` 结构相似的占位符布局（例如，一个标题骨架、几行文本骨架）。

- [x] **Task 2: 在 UI 中实现条件渲染**
  - [x] 在 `side-panel-app.tsx` 中，找到渲染 `InsightCard` 的位置。
  - [x] 使用三元运算符或 `if` 语句，根据 `isLoading` 状态进行条件渲染：
    ```jsx
    {isLoading ? <InsightCardSkeleton /> : <InsightCard insight={insight} />}
    ```
  - [x] 确保在 `isLoading` 状态切换时，UI 能够正确地在骨架屏和真实卡片之间切换。

- [x] **Task 3: 集成 `isLoading` 状态**
  - [x] 确认在 `side-panel-app.tsx` 的 API 调用流程中，`isLoading` 状态被正确管理：
    - 在调用 `apiService` **之前**，`setIsLoading(true)`。
    - 在 `Promise` 完成（`.then()` 或 `.finally()`）**之后**，`setIsLoading(false)`。 